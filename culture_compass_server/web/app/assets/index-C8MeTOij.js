(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}})();function u(e,t){const r=window.Globe;if(!r)return;const i=r().globeImageUrl("//unpkg.com/three-globe/example/img/earth-blue-marble.jpg").backgroundColor("rgba(0,0,0,0)").atmosphereColor("#2F4A3C").pointsData(t).pointAltitude(.01).pointColor(()=>"#C4A86A").pointRadius(.5).enablePointerInteraction(!1);i(e),i.controls().autoRotate=!0,i.controls().autoRotateSpeed=.4}async function a(e){const t=await fetch(`/api/report/${e}`);return t.ok?t.json():null}function f(e){var c;const t=document.getElementById("report-title"),r=document.getElementById("report-subtitle"),i=document.getElementById("brief"),o=document.getElementById("sources"),n=document.getElementById("claims"),s=document.getElementById("contradictions");t&&(t.textContent=e.room.title),r&&(r.textContent=e.room.description||"Collaborative brief with receipts."),i&&(i.innerHTML=(c=e.brief)!=null&&c.markdown?`<pre>${e.brief.markdown}</pre>`:"<p>No brief generated yet.</p>"),o&&(o.innerHTML=e.sources.map(l=>`<li><a href="${l.url}" target="_blank">${l.title||l.url}</a></li>`).join("")),n&&(n.innerHTML=e.claims.map(l=>`<li><strong>${l.claimText}</strong><br/><em>${l.quote}</em></li>`).join("")),s&&(s.innerHTML=e.contradictions.map(l=>`<li><strong>${l.disagreementType}</strong><br/>${l.explanation}</li>`).join(""))}function d(){const e=window.location.pathname.split("/").filter(Boolean),t=e.indexOf("report");return t===-1||t+1>=e.length?null:e[t+1]}async function m(){const e=d();if(!e)return;const t=await a(e);t&&f(t);const r=document.getElementById("globe");r&&u(r,[])}m();
